import{f as e,h as l,a7 as a,aX as s,aW as t,b8 as o,b9 as n,aV as i,c as u,o as r,F as d,b as c,G as m,B as v,w as p,d as b,H as g,N as f,j as y,bu as w,t as x,ba as k,n as h,I as B,T as _,bk as V,R as T,a as S,E as A,bb as F,a3 as N,bc as q,bd as z,be as I,bf as E,bg as L,bh as $,bi as C,z as R,bj as j}from"./BArbQupS.js";const M={key:0,class:"ml-5px"},U={class:"text-20px"},W={class:"min-h-60px py-10px"},G={class:"text-16px"},O={class:"flex mt-10px"},D=e({__name:"quickSwap",props:{quickBuyValue:{},row:{},appendTo:{default:"#__nuxt"},buttonBg:{default:"rgba(18, 184, 134, 0.15)"},mainNameVisible:{type:Boolean},classNames:{default:""},size:{default:"medium"}},emits:["submitSwap"],setup(e,{emit:D}){const{t:H}=l(),P=e,Q=a(),X=s(!1),J=s(!1),K=s(""),Y=t("noReminderQuickBuy",!1),Z=D;function ee(){var e;if(Z("submitSwap"),!F())return;if(X.value)return;if(new N(P.quickBuyValue||0).lte(0))return void q({title:"Error",type:"error",message:H("amountMustG0")});const{row:l}=P;K.value=H("quickBuyMsg",{a:P.quickBuyValue,m:(null==(e=k(P.row.chain))?void 0:e.main_name)||"",s:l.symbol||(l.target_token==l.token0_address?l.token0_symbol:l.token1_symbol)}),Y.value?se():J.value=!0}const le=s(),ae=o();async function se(){var e;J.value=!1;const{chain:l}=P.row;X.value=!0,await async function(e){var l;const a=Q.getWalletAddress(e);if(!a)return;const s=await j({chain:e,tokens:[E(e)],walletAddress:a}),t=(null==s?void 0:s[0])||{};le.value={...t,symbol:null==(l=k(e))?void 0:l.main_name,chain:e,address:t.token||t.address,decimals:t.decimals||t.decimal}}(l);const a=le.value,s=null==(e=new N(P.quickBuyValue||0).toFixed().match(new RegExp(`[0-9]*(\\.[0-9]{0,${(null==a?void 0:a.decimals)||18}})?`)))?void 0:e[0];return(Number(s)||0)<=0?(q({title:"Error",type:"error",message:H("amountTooSmall")}),void(X.value=!1)):new N(s||0).gt((null==a?void 0:a.balance)||0)?(q({title:"Error",type:"error",message:H("insufficientBalance")}),void(X.value=!1)):void async function(e){var l,a,s;const{chain:t}=P.row,o="solana"===t,{botSettings:n}=ae,i=null==(l=null==n?void 0:n[t])?void 0:l.selected,u=null==(a=null==n?void 0:n[t])?void 0:a[i];if(o&&(null==u?void 0:u.mev)&&!(await Q.getBundleAvailable()))return void(X.value=!1);const{gasTip1List:r,gasTip2List:d}=z(I().gasTip,"solana"),c=(null==u?void 0:u.mev)?r:d,m=(null==u?void 0:u.mev)?null==u?void 0:u.gas[0]:null==(s=null==u?void 0:u.gas)?void 0:s[1];let v={};if(o){let e=(null==m?void 0:m.customFee)||(null==c?void 0:c[null==m?void 0:m.level])||"0.002";(null==u?void 0:u.mev)&&new N(e).lt("0.002")&&(e="0.002"),v.priorityFee=new N(e).times(10**9).toFixed(0)}else{const e=0===Number(null==m?void 0:m.customFee)?"0":(null==m?void 0:m.customFee)||(null==c?void 0:c[null==m?void 0:m.level])||"3";v.gasTip=Number(new N(e).times(10**9).toFixed(0)),v.contractType=0,v.chain=t}const p=E(t),b=(null==u?void 0:u.slippage)||"9",g=Q.getWalletAddress(t);if(!g)return;v={...v,batchId:Date.now().toString(),swapList:[{creatorAddress:g,inAmount:new N(e||0).times(10**le.value.decimals||0).toFixed(0)}],inTokenAddress:p,outTokenAddress:P.row.token||P.row.target_token,swapType:1,isPrivate:(null==u?void 0:u.mev)||!1,slippage:"auto"!==b?Number(new N(b).times(100).toFixed(0)):900,autoSell:(null==u?void 0:u.autoSell)||!1};(o?L(v):$(v)).then((e=>function(e,l){if(e){let e=setTimeout((()=>{q({type:"success",message:H("transactionsSubmitted")}),te.placeOrderUpdate++,X.value=!1}),500);const a=R((()=>oe.wsResult.tgbot),(s=>{var t,o,n,i;s.batchId===l&&(e&&(clearTimeout(e),e=null),te.placeOrderSuccess++,(null==(o=null==(t=null==s?void 0:s.txList)?void 0:t[0])?void 0:o.success)?(q({type:"success",message:H("tradeSuccess")}),a()):(C((null==(i=null==(n=null==s?void 0:s.txList)?void 0:n[0])?void 0:i.failMessage)||"swap error"),a()),X.value=!1)}))}}(e,v.batchId))).catch((e=>{C(e||"swap error"),X.value=!1}))}(s)}const te=n(),oe=i();return(e,l)=>{const a=g,s=_,t=A,o=V;return r(),u(d,null,[c(s,{disabled:!Number(e.quickBuyValue),loading:y(X),color:e.buttonBg,class:h(["flex items-center [&&]:px-12px",e.classNames]),style:f([{"--el-button-hover-bg-color":"rgba(18, 184, 134, 0.3)","--el-color-black":"#12B886","--el-button-border-color":"transparent","--el-button-hover-border-color":"transparent","--el-button-disabled-text-color":"#12B886","--el-button-disabled-border-color":"transparent","--el-button-disabled-bg-color":"#12B8861A"},{"font-size":y(w)(e.size).text}]),onClick:B(ee,["stop","prevent"])},{default:p((()=>{var l;return[c(a,{style:f({"font-size":y(w)(e.size).flash}),class:"mr-4px",name:"mynaui:lightning-solid"},null,8,["style"]),b(" "+x(e.quickBuyValue||0)+" ",1),e.mainNameVisible?(r(),u("span",M,x((null==(l=("getChainInfo"in e?e.getChainInfo:y(k))(e.row.chain))?void 0:l.main_name)||""),1)):v("",!0)]})),_:1},8,["disabled","loading","color","class","style"]),y(J)?(r(),m(o,{key:0,modelValue:y(J),"onUpdate:modelValue":l[1]||(l[1]=e=>T(J)?J.value=e:null),title:e.$t("buy"),width:"400px","append-to":e.appendTo},{header:p((()=>[S("span",U,x(e.$t("buy")),1)])),footer:p((()=>[c(s,{type:"primary",class:"w-full",size:"large",onClick:B(se,["stop"])},{default:p((()=>[b(x(e.$t("confirm1")),1)])),_:1})])),default:p((()=>[S("div",W,[S("div",G,x(y(K)),1),S("div",O,[c(t,{modelValue:y(Y),"onUpdate:modelValue":l[0]||(l[0]=e=>T(Y)?Y.value=e:null),class:"[&&]:[--el-checkbox-text-color:--d-999-l-666]",label:e.$t("noAlert"),size:"large"},null,8,["modelValue","label"])])])])),_:1},8,["modelValue","title","append-to"])):v("",!0)],64)}}});export{D as _};
